# Проект ВКР в $\LaTeX$

Данный шаблон можно использовать для курсовой или ВКР (бакалаврская или магистерская). 

Создан новый класс esdiploma.csl. В основном документе ссылаемся на этот класс. 
Класс создан на базе report. Там же настройки полей, шрифтов и всего всего. Можно модифицировать. 
Основная идея -- сделать шаблон титульной страницы, параметры которой заполняются в начале основного файла (инструкция в закомментированном тексте). 

Еще показано, как сделать ссылки в виде (Государственная..., 2011). 

И есть пример разворота картинки вместе с подписью на 90гр.

Также есть пример с newcommand для задания специальных команд, например, для воспроизведения длинного текста или математического символа. 

Если нужно сделать номера страницы, как предписано для кандидатских СПбГУ (сверху страницы посередине), нужно в стилевом файле раскомментировать строки 87-106

Стиль цитирования основан на ГОСТе Котельникова, но немного допилен. 

### Баги с литературным стилем ugost2008

Если нужно использовать именно Котельниковский ugost2008, то нужно выбрать реализацию LuaLaTeX 2020 (не выше). Если версия выше, идет ошибка по кодировке.  

### Про стили

`gost_style.bst`: попытка скрестить стиль ГОСТ и журнальный harvard. Получилось, что-то наподобие стиля МАИК. Все ссылки на ститьи и книги начинаются со списка авторов, но если авторов > 5, то паровоз редуцируется до перечисления 4 авторов + *et al.*

`gost_style_mod.bst`: больше приближен к ГОСТ. Если авторов < 4, то все авторы указываются до названия. Если > 4, то сначала указывается *первый автор et al.*, затем идет название, затем идет перечисление первых 4 авторов + *et al.*. 

### Памятка для редактирования стиля bst

В целом, оба `bst` файла схожи, отличия в 5 строках. Параметры можете поменять сами под свой запрос. 

`before` -- авторский блок до названия работы;
`after` -- авторский блок после названия работы;
`N` -- количество авторов в публикации.

Блок на строках 1431--1441 `FUNCTION {author.after}` определяет при каком количестве авторов перемещать весь авторский коллектив после названия статьи. 

стр 1435: для `gost_style.bst`: `{author num.names$ #20 >` -- тут можно поставить и больше для надежности, чтобы всегда весь авторский коллектив располагался в начале, то есть `before`;

стр 1435: для `gost_style_mod.bst`: `{author num.names$ #3 >` -- то есть, если у нас три и меньше авторов статьи, то они будут перечислены сначала (`before`), но от 4х и более, перечисление авторов будет производиться после названия.  

Дальше нужно определить, сколько имен мы будем выводить. Это определяется в блоках `FUNCTION {format.names}` (стр 764) и `FUNCTION {format.names.rev}` (стр 824)

#### для `gost_style.bst`: 

стр 774: если задано следующее значение (` { nameptr #2 =`), то при `numnames #3` (стр 775, что указывает на условие общего количества авторов, в данном случае > 3), вместо упоминания второго автора будет выводиться et al. в блоке `before`. В шаблоне выбраны оба значения 5, чтобы выводилось 4 автора, дальше список заканчивался et al.

Если нужно вывести весь список авторов, то в значении `nameptr` можно поставить либо 1, либо какое-нибудь большое значение, например, 30.

#### для `gost_style_mod.bst`:

стр 774: если задано следующее значение (` { nameptr #2 =`), то при `numnames #3` (стр 775, что указывает на условие общего количества авторов, в данном случае > 3), вместо упоминания второго автора будет выводиться et al. в блоке `before`. 

теперь идем в блок `FUNCTION {format.names.rev}` (стр 824--857):

в строках 834 и 835 определяем, где и при каком условии заканчивать список авторов сокращением et al. в блоке `after`. Например, мы хотим, чтобы при более, чем 5 авторах, выводился список из 4 авторов, после чего выводился et al. Тогда ставим значения 5 в обе строки: 

`{ nameptr #5 =
  numnames #5 > and`

Если нужно вывести весь список авторов, то в значении `nameptr` можно поставить либо 1, либо какое-нибудь большое значение, например, 30. 



стр 1398: пишем авторов `before`, если их больше чем `N`

стр 1435: при больше чем `N` авторов, убирает список авторов в блоке `after`.

стр 2237: сортировка по автору или по названию в зависимости от количества авторов.  

### Про сокращение до инициалов

стр 772 `"{vv~}{ll}{~jj}{~ff}" format.name$ 't :=` нужно заменить на `"{vv~}{ll}{~jj}{~f.}" format.name$ 't :=` и тогда английские имена сократятся до инициалов, а с русскими случится креш. 

### Ссылки на отчеты и записки к геол картам

Если есть источник типа "Объяснительная записка к карте", производственный отчет или монография, ссылка на которые должна быть вида "Геодинамическая..., 1900", то тип источника должен быть `@book`, составители (они же авторы `compiler`). Для отображения самой ссылки применяется костыль, ломающий принципы natbib (эту строку нужно вставить в любое место между `\begin{document}` и `\end{document}`): `\defcitealias{citationkey}{Первоеслово..., 20XX}`. Где `citationkey` -- ключ из `bib` файла. Ссылка в тексте для таких источников выполняется командой `\citepalias{citationkey}`. 
